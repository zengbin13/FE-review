(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/circle/circle_detail/circle_detail"],{1082:function(e,t,i){"use strict";(function(e){i("d38d"),i("921b");n(i("66fd"));var t=n(i("d392"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("6e42")["createPage"])},"1f60":function(e,t,i){},"58de":function(e,t,i){"use strict";var n=i("1f60"),s=i.n(n);s.a},7320:function(e,t,i){"use strict";var n,s=function(){var e=this,t=e.$createElement;e._self._c},r=[];i.d(t,"b",function(){return s}),i.d(t,"c",function(){return r}),i.d(t,"a",function(){return n})},9425:function(e,t,i){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(i("a34a")),r=i("2f62");function a(e){return e&&e.__esModule?e:{default:e}}function c(e,t,i,n,s,r,a){try{var c=e[r](a),o=c.value}catch(u){return void i(u)}c.done?t(o):Promise.resolve(o).then(n,s)}function o(e){return function(){var t=this,i=arguments;return new Promise(function(n,s){var r=e.apply(t,i);function a(e){c(r,n,s,a,o,"next",e)}function o(e){c(r,n,s,a,o,"throw",e)}a(void 0)})}}var u=function(){return i.e("components/load-more").then(i.bind(null,"8627"))},h=function(){return i.e("components/uni-popup/uni-popup").then(i.bind(null,"ece0"))},l=function(){return i.e("components/authLevel").then(i.bind(null,"771c"))},d={components:{LoadMore:u,uniPopup:h,authLevel:l},data:function(){return{dynaId:0,info:{},loadingType:0,pageNum:0,pageSize:20,list:[],content:"",isShowtheme:!1,commentShow:!1,showItem:{},showItem_index:0,loadingType1:0,pageNum1:0,pageSize1:20,list1:[],replyTotal:0,replyId:0,replyType:0,replyToUserId:0,placeholder:"回复:",replycontent:"",isHeight:0,isInput:!1,swiperHeight:0,swiperHeight1:0,serviceImgUrl:this.$service.ServiceImgUrl,bar_Height:0}},computed:(0,r.mapState)(["hasLogin","userInfo"]),methods:{init:function(){var t=o(s.default.mark(function t(){var i,n;return s.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$service.dynamic.info({dynaId:this.dynaId});case 2:i=t.sent,i.success?(n=i.data.data,n.contextImgArray=this.$util.getImageList(n.contextImg,this.serviceImgUrl),this.info=n,e.setNavigationBarTitle({title:this.info.theme||"主题"}),1!=this.info.chargeType||this.info.isPay||e.redirectTo({url:"/pages/free_theme/free_theme?dynaId="+this.dynaId})):setTimeout(function(){e.navigateBack()},1500);case 4:case"end":return t.stop()}},t,this)}));function i(){return t.apply(this,arguments)}return i}(),comment:function(){var e=o(s.default.mark(function e(){var t,i,n;return s.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(0==this.loadingType){e.next=2;break}return e.abrupt("return");case 2:return this.loadingType=1,t=this.pageNum+1,e.next=6,this.$service.comment.list({dynaId:this.dynaId,pageNum:t,pageSize:this.pageSize});case 6:i=e.sent,this.loadingType=0,0==i.data.status&&(n=i.data.data.records,n.length>0&&(this.pageNum=t,this.list=this.list.concat(n)),n.length<this.pageSize&&(this.loadingType=-1)),0==this.list.length&&(this.loadingType=3);case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),refreshComment:function(){this.loadingType=0,this.pageNum=0,this.list.length&&this.list.splice(0,this.list.length),this.comment(),this.init()},previewImage:function(t){var i=this.info.contextImgArray;e.previewImage({urls:i,current:t,fail:function(e){console.log(n("previewImage.fail",e," at pages\\circle\\circle_detail\\circle_detail.vue:279"))}})},showText:function(){this.isShowtheme=!0,this.$refs.showtheme.open()},hideText:function(){this.$refs.showtheme.onTap();var e=this;setTimeout(function(){e.isShowtheme=!1},1e3)},sendText:function(){var e=o(s.default.mark(function e(){var t,i;return s.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.content.trim(),t){e.next=4;break}return this.$util.showToast("请输入评论内容"),e.abrupt("return");case 4:return e.next=6,this.$service.comment.dynamics({dynaId:this.dynaId,content:t});case 6:i=e.sent,i.success&&(this.$util.showSuccess("评论成功"),this.content="",this.hideText(),this.refreshComment());case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),praise:function(){var e=o(s.default.mark(function e(){var t,i,n;return s.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.info.isPraise?this.$service.userDynamicPraise.praiseUnlike:this.$service.userDynamicPraise.praiseLike,e.next=3,t({dynaId:this.dynaId});case 3:i=e.sent,i.success&&(n=this.info,n.isPraise=!n.isPraise,n.isPraise?n.fabulousNum++:n.fabulousNum--,this.info=n);case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),likeFabulous:function(){var e=o(s.default.mark(function e(t){var i,n,r;return s.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i=this.list[t],n=i.isZan?this.$service.commenMth.cai:this.$service.commenMth.zan,e.next=4,n({commentId:i.id,status:0});case 4:r=e.sent,r.success&&(i.isZan=!i.isZan,i.isZan?i.zanNum++:i.zanNum--,this.list.splice(t,1,i));case 6:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),unlikeFabulous:function(){var e=o(s.default.mark(function e(t){var i,n,r;return s.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i=this.list[t],n=i.isCai?this.$service.commenMth.cai:this.$service.commenMth.zan,e.next=4,n({commentId:i.id,status:1});case 4:r=e.sent,r.success&&(i.isCai=!i.isCai,i.isCai?i.caiNum++:i.caiNum--,this.list.splice(t,1,i));case 6:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),delCommont:function(){var t=o(s.default.mark(function t(){var i;return s.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.showItem.fromUid==this.userInfo.id){t.next=2;break}return t.abrupt("return");case 2:i=this,e.showModal({title:"删除",content:"您确认要删除？",success:function(){var e=o(s.default.mark(function e(t){var n;return s.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t.confirm){e.next=5;break}return e.next=3,i.$service.comment.del({circleId:i.info.circleId,dynaId:i.info.id,commentId:i.showItem.id});case 3:n=e.sent,n.success&&(i.$util.showSuccess("删除成功"),i.comHide(),i.refreshComment());case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()});case 4:case"end":return t.stop()}},t,this)}));function i(){return t.apply(this,arguments)}return i}(),toComment:function(e){this.showItem_index=e,this.showItem=this.list[e],this.commentShow=!0,this.$refs.showcomment.open(),this.refreshReplys(),this.replyCommentUserTap()},comHide:function(){this.commentShow=!1,this.$refs.showcomment.onTap()},refreshReplys:function(){this.loadingType1=0,this.pageNum1=0,this.list1.length&&this.list1.splice(0,this.list1.length),this.selectReplys()},selectReplys:function(){var e=o(s.default.mark(function e(){var t,i,n,r;return s.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(0==this.loadingType1){e.next=2;break}return e.abrupt("return");case 2:return this.loadingType1=1,t=this.pageNum1+1,e.next=6,this.$service.reply.list({commentId:this.showItem.id,pageNum:t,pageSize:this.pageSize1});case 6:i=e.sent,this.loadingType1=0,0==i.data.status&&(this.replyTotal=i.data.data.Replies.total,n=i.data.data.Replies.records,n.length>0&&(this.list1=this.list1.concat(n),this.pageNum1=t),n.length<this.pageSize1&&(this.loadingType1=-1)),0==this.list1.length&&(this.loadingType1=3),this.showItem_index<this.list.length&&(r=this.list[this.showItem_index],r.replyCount=this.replyTotal,this.list.splice(this.showItem_index,1,r));case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),replyCommentUserTap:function(){this.placeholder="回复："+this.showItem.username,this.replyId=this.showItem.id,this.replyType=0,this.replyToUserId=this.showItem.fromUid},replyUserTap:function(t){var i=this.list1[t];if(this.userInfo.id!=i.fromUid)this.placeholder="回复："+i.fromUser,this.replyId=i.id,this.replyType=1,this.replyToUserId=i.fromUid;else{var n=this;e.showActionSheet({itemList:["删除"],success:function(e){n.delReplys(i.id)}})}},toSend:function(){var e=o(s.default.mark(function e(){var t,i;return s.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.replycontent.trim(),t){e.next=4;break}return this.$util.showToast("请输入回复内容"),e.abrupt("return");case 4:return e.next=6,this.$service.reply.dynamics({commentId:this.showItem.id,content:t,replyId:this.replyId,replyType:this.replyType,toUserId:this.replyToUserId});case 6:i=e.sent,i.success&&(this.$util.showSuccess("回复成功"),this.replycontent="",this.refreshReplys());case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),delReplys:function(){var e=o(s.default.mark(function e(t){var i;return s.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$service.reply.del({circleId:this.info.circleId,dynaId:this.info.id,commentId:this.showItem.id,replyId:t});case 2:i=e.sent,i.success&&(this.$util.showSuccess("删除成功"),this.refreshReplys());case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),toCollect:function(){var e=o(s.default.mark(function e(){var t,i,n;return s.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.info.isCollect?this.$service.userDynamic.unlikeDynamic:this.$service.userDynamic.likeDynamic,e.next=3,t({dynaId:this.info.id});case 3:i=e.sent,i.success&&(n=this.info,n.isCollect=!n.isCollect,this.info=n);case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),_ipt_blur:function(){e.pageScrollTo({scrollTop:this.scrollTopPX,duration:0})},isFocus:function(e){this.isHeight=e.detail.height}},onPageScroll:function(e){this.scrollTopPX=e.scrollTop},onLoad:function(t){this.dynaId=t.dynaId||0,this.init(),this.comment();var i=e.getSystemInfoSync();this.bar_Height=i.statusBarHeight,this.swiperHeight=i.windowHeight-e.upx2px(300),this.swiperHeight1=i.windowHeight-e.upx2px(126)},onBackPress:function(e){if(this.commentShow)return this.comHide(),!0}};t.default=d}).call(this,i("6e42")["default"],i("0de9")["default"])},d392:function(e,t,i){"use strict";i.r(t);var n=i("7320"),s=i("d44a");for(var r in s)"default"!==r&&function(e){i.d(t,e,function(){return s[e]})}(r);i("58de");var a,c=i("f0c5"),o=Object(c["a"])(s["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],a);t["default"]=o.exports},d44a:function(e,t,i){"use strict";i.r(t);var n=i("9425"),s=i.n(n);for(var r in n)"default"!==r&&function(e){i.d(t,e,function(){return n[e]})}(r);t["default"]=s.a}},[["1082","common/runtime","common/vendor"]]]);