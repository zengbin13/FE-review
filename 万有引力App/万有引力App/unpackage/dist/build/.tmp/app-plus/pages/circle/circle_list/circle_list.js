(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/circle/circle_list/circle_list"],{"2e1f":function(t,e,i){"use strict";var s=i("7f68"),r=i.n(s);r.a},"3d5a":function(t,e,i){"use strict";(function(t,s){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(i("a34a"));function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e,i,s,r,n,a){try{var c=t[n](a),l=c.value}catch(o){return void i(o)}c.done?e(l):Promise.resolve(l).then(s,r)}function c(t){return function(){var e=this,i=arguments;return new Promise(function(s,r){var n=t.apply(e,i);function c(t){a(n,s,r,c,l,"next",t)}function l(t){a(n,s,r,c,l,"throw",t)}c(void 0)})}}var l=function(){return i.e("components/load-more").then(i.bind(null,"8627"))},o=function(){return i.e("components/authLevel").then(i.bind(null,"771c"))},u=function(){return i.e("components/uni-popup/uni-popup").then(i.bind(null,"ece0"))},h={components:{LoadMore:l,AuthLevel:o,uniPopup:u},data:function(){return{cur:0,type:"",circleId:0,circleInfo:{},cirTab_list:[{tit:"全部",loadingType:0,pageNum:0,status:"",list:[]},{tit:"精华",loadingType:0,pageNum:0,status:"1",list:[]},{tit:"打赏排行榜",url:"/pages/ranking/ranking?circleId="}],pageSize:20,showItem:{},swiperHeight:0,swiperCurent:0,scrollHeight:0,topShow:!1,scrollTop:0,oldScrollTop:0,rewardShow:!1,rewardAmount:"",isManage:!1,canTheme:!1,serviceImgUrl:this.$service.ServiceImgUrl,bar_Height:t.getSystemInfoSync().statusBarHeight}},methods:{loadData:function(){var t=c(r.default.mark(function t(){var e,i,s,n,a;return r.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.cirTab_list[this.cur],0==e.loadingType){t.next=3;break}return t.abrupt("return");case 3:return e.loadingType=1,i=e.pageNum+1,t.next=7,this.$service.dynamic.themeCircle(this.circleId,i,this.pageSize,e.status,1);case 7:if(s=t.sent,e.loadingType=0,s.success){if(n=s.data.data.records,1==i&&e.list.length&&e.list.splice(0,e.list.length),n.length>0)for(e.pageNum=i,a=0;a<n.length;a++)n[a].contextImgArray=this.$util.getImageList(n[a].contextImg,this.serviceImgUrl),e.list.push(n[a]);(s.data.data.total<=e.pageNum*this.pageSize||n.length<this.pageSize)&&(e.loadingType=2)}0==e.list.length&&(e.loadingType=3),e.isLoad=!0,this.cirTab_list.splice(this.cur,1,e);case 13:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),loadCircle:function(){var e=c(r.default.mark(function e(){var i;return r.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$service.circle.showInfo({circleId:this.circleId});case 2:if(i=e.sent,!i.success){e.next=13;break}if(this.circleInfo=i.data.data,this.circleInfo.isJoin||this.circleInfo.isCreate||this.circleInfo.isManage){e.next=8;break}return t.redirectTo({url:"/pages/circle/circle_not/circle_not?circleId="+this.circleId}),e.abrupt("return");case 8:t.setNavigationBarTitle({title:this.circleInfo.circleTitle||"圈子"}),this.isManage=this.circleInfo.isCreate||this.circleInfo.isManage,this.loadCircleInfo(),e.next=14;break;case 13:setTimeout(function(){t.switchTab({url:"/pages/home/home"})},1500);case 14:case"end":return e.stop()}},e,this)}));function i(){return e.apply(this,arguments)}return i}(),loadCircleInfo:function(){var t=c(r.default.mark(function t(){var e,i,s;return r.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$service.circle.info({circleId:this.circleId});case 2:e=t.sent,e.success&&(i=e.data.data.circleInfo,s=i.circleReleaseRules,this.canTheme=2==s||(1==s?i.isCreate||i.isManage:i.isCreate));case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),refresh:function(){var t=c(r.default.mark(function t(e){var i,s,n,a,c,l,o;return r.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(i=this.cirTab_list[e],s=i.pageNum,0!=s){t.next=5;break}return this.cur==e?(i.loadingType=0,this.cirTab_list.splice(e,1,i),this.loadData()):(i.loadingType=0,i.isLoad=!1,this.cirTab_list.splice(e,1,i)),t.abrupt("return");case 5:n=[],a=1;case 7:if(!(a<=s)){t.next=15;break}return t.next=10,this.$service.dynamic.themeCircle(this.circleId,a,this.pageSize,i.status,1);case 10:if(c=t.sent,c.success){if(l=c.data.data.records,l.length>0)for(o=0;o<l.length;o++)l[o].contextImgArray=this.$util.getImageList(l[o].contextImg,this.serviceImgUrl),n.push(l[o]);a==s&&(c.data.data.total<=s*this.pageSize||l.length<this.pageSize?i.loadingType=2:i.loadingType=0)}case 12:a++,t.next=7;break;case 15:i.list=n,this.cirTab_list.splice(e,1,i);case 17:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),refreshAll:function(){for(var t=0;t<2;t++)this.refresh(t)},spliceItem:function(t,e,i){for(var s=0;s<this.cirTab_list[t].list.length;s++)if(this.cirTab_list[t].list[s].id==this.showItem.id){i?this.cirTab_list[t].list.splice(s,1,i):this.cirTab_list[t].list.splice(s,1);break}if(0==this.cirTab_list[t].list.length){var r=this.cirTab_list[t];r.loadingType=3,this.cirTab_list.splice(t,1,r)}},setEssence:function(){var e=c(r.default.mark(function e(i){var s,n,a;return r.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.toggleClose(),s=this.showItem.type?0:1,e.next=4,this.$service.dynamic.setting(this.showItem.id,s);case 4:n=e.sent,n.success&&(t.showToast({title:n.data.msg||"设置成功"}),this.showItem.type=s,this.spliceItem(0,this.showItem.id,this.showItem),0==s?this.spliceItem(1,this.showItem.id):this.cirTab_list[1].isLoad&&(this.cirTab_list[1].list.splice(0,0,this.showItem),1==this.cirTab_list[1].list.length&&(a=this.cirTab_list[1],a.loadingType=2,this.cirTab_list.splice(1,1,a))),this.refreshAll());case 6:case"end":return e.stop()}},e,this)}));function i(t){return e.apply(this,arguments)}return i}(),setTop:function(){var e=c(r.default.mark(function e(){var i,s;return r.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.toggleClose(),i=this.showItem.stick?0:1,e.next=4,this.$service.dynamic.stick(this.showItem.id,i);case 4:s=e.sent,s.success&&(t.showToast({title:s.data.msg||"设置成功"}),this.showItem.stick=i,this.refreshAll());case 6:case"end":return e.stop()}},e,this)}));function i(){return e.apply(this,arguments)}return i}(),dynamicDel:function(){this.toggleClose();var e=this;t.showModal({title:"删除",content:"你确定要删除这条主题吗？",success:function(i){i.confirm&&(console.log(s(i," at pages\\circle\\circle_list\\circle_list.vue:387")),e.$service.dynamic.del(e.showItem.id).then(function(i){i.success&&(t.showToast({title:i.data.msg||"操作成功"}),e.spliceItem(0,e.showItem.id),e.spliceItem(1,e.showItem.id))}))}})},titleChange:function(e){var i=Number(e);this.cirTab_list[i].url?t.navigateTo({url:this.cirTab_list[i].url}):(this.cur=i,this.cirTab_list[this.cur].isLoad||this.loadData())},togglePopup:function(t,e){var i=this;this.showItem=this.cirTab_list[t].list[e],this.$nextTick(function(){i.$refs.showshare.open()})},toggleClose:function(){this.$refs.showshare.onTap()},goDetail:function(e,i){var s=this.cirTab_list[e].list[i];0==s.chargeType||1==s.chargeType&&1==s.isPay?t.navigateTo({url:"/pages/circle/circle_detail/circle_detail?dynaId="+s.id}):t.navigateTo({url:"/pages/free_theme/free_theme?dynaId="+s.id})},toManage:function(){t.navigateTo({url:"/pages/circle/circle_manage/circle_manage?circleId="+this.circleId})},toReward:function(t,e){this.showItem=this.cirTab_list[t].list[e],this.rewardAmount="",this.$refs.showreward.open()},rewardAmountInput:function(t){t.detail.value=this.$util.demicalInput(t.detail.value),this.$nextTick(function(){this.rewardAmount=t.detail.value})},rewardSubmit:function(){if(this.rewardAmount&&"0"!=this.rewardAmount){var e=this.rewardAmount;this.rewardHide(),t.navigateTo({url:"/pages/circle/circle_list/bounty_pay/bounty_pay?bountyType=1&circleId=".concat(this.circleId,"&dynamicId=").concat(this.showItem.id,"&price=").concat(e)})}else this.$util.showToast("请输入打赏金额")},rewardHide:function(){this.$refs.showreward.onTap(),this.rewardAmount=""},scrollChange:function(t){var e=t.detail.scrollTop;this.topShow=e>100,this.oldScrollTop=e},toTop:function(){this.scrollTop=this.oldScrollTop;var t=this;t.$nextTick(function(){t.$util.scrollTop(t.scrollTop,function(e){t.scrollTop=e})})},themeOpen:function(){this.$refs.showtheme.open()},themeCancel:function(){this.$refs.showtheme.onTap()},toFree:function(){this.themeCancel(),t.navigateTo({url:"/pages/theme/theme?circleId="+this.circleId})},toPay:function(){this.themeCancel(),t.navigateTo({url:"/pages/theme/theme_pay/theme_pay?circleId="+this.circleId})},praiseTap:function(){var t=c(r.default.mark(function t(e,i){var s,n,a;return r.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return s=this.cirTab_list[e].list[i],n=s.isPraise?this.$service.userDynamicPraise.praiseUnlike:this.$service.userDynamicPraise.praiseLike,t.next=4,n({dynaId:s.id});case 4:a=t.sent,a.success&&(s.isPraise=!s.isPraise,s.isPraise?s.fabulousNum++:s.fabulousNum--,this.cirTab_list[e].list.splice(i,1,s));case 6:case"end":return t.stop()}},t,this)}));function e(e,i){return t.apply(this,arguments)}return e}()},onLoad:function(e){this.circleId=e.circleId||0,this.cirTab_list[2].url="/pages/ranking/ranking?circleId="+this.circleId,this.swiperHeight=t.getSystemInfoSync().windowHeight},onShow:function(){this.loadCircle(),this.refreshAll()},onNavigationBarButtonTap:function(e){0==e.index?this.toManage():1==e.index&&t.navigateTo({url:"/pages/code/code?circleId="+this.circleId})}};e.default=h}).call(this,i("6e42")["default"],i("0de9")["default"])},"7b07":function(t,e,i){"use strict";var s,r=function(){var t=this,e=t.$createElement;t._self._c},n=[];i.d(e,"b",function(){return r}),i.d(e,"c",function(){return n}),i.d(e,"a",function(){return s})},"7f68":function(t,e,i){},"8ae2":function(t,e,i){"use strict";(function(t){i("d38d"),i("921b");s(i("66fd"));var e=s(i("9f55"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("6e42")["createPage"])},"9f55":function(t,e,i){"use strict";i.r(e);var s=i("7b07"),r=i("a6cf");for(var n in r)"default"!==n&&function(t){i.d(e,t,function(){return r[t]})}(n);i("2e1f");var a,c=i("f0c5"),l=Object(c["a"])(r["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],a);e["default"]=l.exports},a6cf:function(t,e,i){"use strict";i.r(e);var s=i("3d5a"),r=i.n(s);for(var n in s)"default"!==n&&function(t){i.d(e,t,function(){return s[t]})}(n);e["default"]=r.a}},[["8ae2","common/runtime","common/vendor"]]]);