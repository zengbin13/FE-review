# JavaScript 的常用功能模块



## 正则表达式

> https://juejin.cn/post/6844904119463837704
>
> https://juejin.cn/post/6844904119463837704

### JavaScript中正则表达式

**String.prototype.match()**

- **检索**返回一个字符串匹配正则表达式的结果

  ```js
  'abc&mno&xyz'.match(/[a-z]+/g)
  // ["abc", "mno", "xyz"]
  ```

**String.prototype.replace()**

- **替换**字符串中被正则表达式匹配的值

  ```js
  'abc-xyz-abc'.replace(/abc/g, 'biu')
  //"biu-xyz-biu"
  ```

**String.prototype.search()**

- **搜索**字符串被正则表达式匹配的**位置**，未找到返回-1

  ```js
  'abc-xyz-abc'.search(/xyz/g)
  //4
  ```

**String.prototype.split()**

- 以正则表达式模式**分割**字符串为数组

  ```js
  'abc-def_mno+xyz'.split(/[-_+]/g)
  // ["abc", "def", "mno", "xyz"]
  ```

**RegExp.prototype.exec()**

- 在一个指定字符串中**执行一个搜索匹配**，返回一个结果数组或 null

  ```js
  /abc/.exec('abc-xyz-abc')
  // ["abc", index: 0, input: "abc-xyz-abc", groups: undefined]
  ```

**RegExp.prototype.test()**

- 执行一个检索，查看正则表达式与指定的字符串是否匹配，返回 true 或 false

  ```js
  /abc/.test('abc-xyz-abc')
  //true
  ```



### 匹配模式-字符匹配（纵向）

| 元字符              |                                                     |
| ------------------- | --------------------------------------------------- |
| 普通元字符-本身含义 | /name/                                              |
| x\|y                | x或y中的一个字符                                    |
| [xyz]               | x或y或z中的一个字符                                 |
| [^xy]               | 除了xy以外的任意一个字符                            |
| [a-z]               | 指定a-z范围中任意一个字符                           |
| [^a-z]              | 除a-z以外的任意一个字符                             |
| ^                   | 以某个元字符开头                                    |
| $                   | 以某个元字符结尾                                    |
| \d                  | [0-9] 表示一个数字，英文digit                       |
| \D                  | [^0-9] 表示除数字外的任意字符                       |
| \w                  | [0-9a-zA-Z_] 表示数字、大小写字母、下划线，英文word |
| \W                  | [^0-9a-zA-Z_] 表示非单词字符                        |
| \s                  | [\t\v\n\r\f] 表示空白符 英文white space             |
| \S                  | [^\t\v\n\r\f] 表示非空白符                          |
| .                   | 除换行符\n 以外的任意字符                           |
| ()                  | 分组符号                                            |
|                     |                                                     |

**多选分支**

<img src="常用功能.assets/image-20210127102643510.png" alt="image-20210127102643510" style="zoom:50%;" />



### 匹配模式-字符匹配（横向）

| 量词元字符 |              |
| ---------- | ------------ |
| *          | 零到多次     |
| +          | 一到多次     |
| ？         | 零到一次     |
| x{m}       | x匹配m次     |
| x{m, }     | x至少匹配m次 |
| x{m, n}    | x匹配m到n次  |

<img src="常用功能.assets/image-20210127103338178.png" alt="image-20210127103338178"  />

### 匹配模式-位置匹配



![image-20210127103516881](常用功能.assets/image-20210127103516881.png)

### 贪婪匹配和惰性匹配

| 贪婪量词 | 惰性量词 |
| -------- | -------- |
| {m, n}?  | {m,n}    |
| {m,}?    | {m,}     |
| ??       | ?        |
| +?       | +        |
| *?       | *        |



## JS的执行机制

- **JavaScript执行流程**

  ```
  一段javascript代码 > 编译阶段 > 执行阶段
  ```

- **变量提升**——代码在**编译阶段**创建执行上下文，并将**变量的声明部分和函数的声明部分保存在执行上下文的变量环境中**，并给变量设置默认值 `undefined`

- 代码编译后生成两部分内容：**执行上下文** 和 **可执行代码**
  - 执行上下文是执行一段代码的运行环境
  - 执行上下文类别
    - 全局执行上下文
    - 函数执行上下文——调用一个函数时，函数体内的代码将被编译
    - eval执行上下文
  - 执行上下文包含
    - **变量环境**——保存变量的值或引用
    - **词法环境**
  
- **调用栈**
  - 管理执行上下文的栈，创建执行上下文将被压入栈中，当前函数执行完当前执行上下文将出栈
  - **JavaScript 引擎追踪函数执行的一个机制**
  - 当分配的调用栈空间被占满时，会引发“堆栈溢出”问题
  
- **块级作用域**

  - 编译阶段，**不会将 `let`、`const`声明的变量存放在变量环境中**，则非全函数可访问

  - 将 `let`、`const`声明的变量存放在**词法环境**

    <img src="常用功能.assets/image-20210129153603270.png" alt="image-20210129153603270" style="zoom: 80%;" />

- **作用域链**

  - 执行上下文的变量环境保存名为**outer**的外部引用，用来**指向外部的执行上下文**
  - 作用域链的顺序不一定是调用栈的顺序，**作用域链是由词法作用域决定的**
  - **词法作用域就是指作用域是由代码中函数声明的位置来决定的，**

- **闭包**

  - 词法作用域规则：**内部函数总可以访问其外部函数中的变量，即使当前外部函数已经销毁**
  - 当函数嵌套时，内层函数引用了外层函数作用域下的变量，(并且返回内层函数)
  - 闭包的销毁：引用闭包的为局部变量，垃圾回收器销毁，全局变量只能手动销毁

- **this**

  - 嵌套函数中的 this 不会继承外层函数的 this 值

- **栈空间堆空间**

  - 静态语言——使用之前需要确认其变量数据类型
  - 弱类型语言——支持隐式类型转换的语言
  - 内存模型——代码空间、栈空间、堆空间
  - 闭包保存在堆空间——进行词法扫描，判断内部函数是否应用外部函数的变量

  <img src="常用功能.assets/image-20210129161324692.png" alt="image-20210129161324692" style="zoom:80%;" />

- **垃圾回收**

  > **代际假说**：大部分对象在内存中存在时间很短，不死的对象会活更久

  - 栈中的垃圾回收
    - JavaScript 引擎会通过向下移动 ESP 来销毁该函数保存在**栈中的执行上下文**
    - 记录当前执行状态的指针（称为 ESP）
  - 堆中的垃圾回收
    - 标记非活动对象——标记完成回收非活动对象内存——内存整理，清除内存碎片
    - **新生代**（1M-8M）——**对象区域**占满时进行垃圾清理，存活对象放置到**空闲区域**，然后进行角色反转；存活两轮或者过大对象将**晋升**到老生区
    - **老生代（标记-清除）**——标记：遍历调用栈，保存有内存引用的为活动对象，未保存内存引用的为非活动对象